<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Living Things&trade;</title>
  <script src="sketch.js"></script>
  <script type="module" src="pattern-master.js"></script>
  <style>
    html,
    body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
    }

    object {
      display: block;
      padding: 0;
      margin: 0;
      width: 100%;
      height: 100%;
      transform-origin: center;
    }
  </style>

</head>

<body>
  <object id="svg_object" type="image/svg+xml"></object>

  <script>

    const list = [
      ['comics/living-things-intro00.svg', '', ''],
      ['comics/three-panel.svg', '', ''],
      ['comics/scroll-master.svg', '', ''],
      ['comics/four-panel.svg', '', ''],
      ['comics/sunday-panel.svg', '', ''],
      ['comics/pop-house.svg', '', '']
    ];

    let index = 0;
    const obj = document.getElementById('svg_object');

    const swap = v => {
      index = (index + v + list.length) % list.length;
      obj.data = list[index][0];
    };

    let startY;
    obj.addEventListener('load', () => {

      obj.contentDocument.addEventListener('touchstart', e => {
        startY = e.touches.length === 1 ? e.touches[0].clientY : null;
      }, { passive: true });

      obj.contentDocument.addEventListener('touchend', e => {

        if (startY === null) return;

        const endY = e.changedTouches[0].clientY;
        const deltaY = endY - startY;

        if (Math.abs(deltaY) > 100) swap(deltaY > 0 ? -1 : 1);

        startY = null;

      }, { passive: true });

    });

    swap(0);

  </script>


</body>